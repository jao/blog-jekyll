---
layout: post
title: ports wipe | homebrew + rvm
---
 
Recently I've heard about <a href="http://twitter.com/mxcl">Max Howell</a>'s <a href="http://mxcl.github.com/homebrew/"><strong>homebrew</strong></a> and Wayne E. Seguin's <a href="http://rvm.beginrescueend.com/"><abbr title="Rails Version Manager"><strong>rvm</strong></abbr></a> from a friend (<a href="http://rodrigofranco.com">caffo</a>), and hearing that they were both pretty cool, I decided to give them a shot.

So if, like me, you are curious about these tools, I'll post what I did to install them.

First I made backups (by moving some folders around)
<pre class="brush: bash; light: true;">
mv ~/.gem ~/gems-old
sudo mv /opt/local ~/macports-old
</pre>

You could also install a gem called 'rubygems_snapshot' and do a
<pre class="brush: bash; light: true;">
gem snapshot export ~/my_gem_list.yml
</pre>
or a simple
<pre class="brush: bash; light: true;">
gem list > ~/gem_list.txt
</pre>
and just plain delete your user gem repository
<pre class="brush: bash; light: true; inline">
rm -rf ~/.gem/
</pre>
Of course I am assuming you were installing them in your home directory, why wouldn't you be?

But if by any chance you have gems installed all over the place you could try running this instead (since this would remove the applicable executables as well):
<pre class="brush: bash; light: true;">
sudo gem list | awk '{print $1}' | xargs sudo gem uninstall -a -x -i
</pre>

Now let's get started.

<h3>Installing homebrew</h3>
<a href="http://wiki.github.com/mxcl/homebrew/installation"><em>official installation instructions</em></a>

Start by running:
<pre class="brush: bash; light: true;">
ruby < <( curl 'http://gist.github.com/raw/323731/25f99360c7de3f72027d8fd07cb369b1c8756ea6/install_homebrew.rb' )
</pre>
or download it from <a href="http://gist.github.com/323731">here</a> and run it yourself.

If by any chance you don't trust or know what that does, you can test it by running the code below that calls this <a href="http://gist.github.com/385387">simple and safe ruby script</a> first.
<pre class="brush: bash; light: true;">
ruby < <( curl 'http://gist.github.com/raw/385387/0cacf4231fceb621c987221ee0aaa380be2bca5d/testing_download_and_run.rb' )
</pre>

If you are curious, this is the source of that gist:
<pre class="brush: ruby; light: true;">
#!/usr/bin/env ruby
puts 'Hello World'
</pre>

Then install <a href="http://developer.apple.com/technologies/xcode.html">Xcode</a>, I recommend downloading the latest version <ins datetime="2010-04-30T17:45:15+00:00">3.2.2 at this moment</ins> from apple's website.

If you are the only person using your computer, you can change the ownership of <em>/usr/local</em> by doing a:
<pre class="brush: bash; light: true;">
sudo chown -R $USER /usr/local
</pre>

Delete some folders:
<pre class="brush: bash; light: true;">
rm -rf /usr/local/include
rm -rf /usr/local/lib
</pre>

After that you can start playing around with homebrew i.e.
<pre class="brush: bash; light: true;">
brew install wget
</pre>
I install most if not all of my stuff from brew now, even mysql and other things that I would rather not get from port.
<strong>Warning: do not remove your system's <em>/usr/bin/ruby</em> since brew depends on it.</strong>

<h3>Let's move to rvm installation now</h3>
(<a href="http://rvm.beginrescueend.com/rvm/install/"><em>official installation instructions</em></a>)

To Install/update from the github repository, which they recommend, run:
<pre class="brush: bash; light: true;">
bash < <( curl 'http://rvm.beginrescueend.com/releases/rvm-install-head' )
</pre>

I had a version of <abbr title="Ruby Enterprise Edition">ree</abbr> installed in /opt, so I just deleted it, I recommend that you do the same.

Add this to your <em>.bash_profile</em> or <em>.bash_rc</em> file, whichever you use.
<pre class="brush: bash; light: true;">
source ~/.rvm/scripts/rvm
</pre>
They advise you to put it at the end of it, and to make sure you have no <em>return</em>s inside your file.

I have a reload function in my file so I just ran reload
<pre class="brush: bash; light: true;>
reload () { source ~/.bash_profile }
</pre>
but you have to <em>source</em> again the files you usually load when you open a new terminal.

Now start playing with rvm! Install your rubies!
<pre class="brush: bash; light: true;">
rvm install ree
rvm install 1.9.1
rvm install 1.9.2-head
</pre>

Set the one you use the most as the default one, at work is ree:
<pre class="brush: bash; light: true;">
rvm ree --default
</pre>

Everytime you open a new terminal, it should be using the default rvm ruby, but to make you might want to add the rvm-prompt feature to your default PS1. Add <em>~/.rvm/bin/rvm-prompt i v</em> to your PS1 variable, something like:
<pre class="brush: bash; light: true;">
# a fancy ps1
export PS1="\e[1;33m\u\e[0m|\e[1;32m\h\e[0m \e[1;34m\w\e[0m |\e[33m$(~/.rvm/bin/rvm-prompt i v)\e[0m|\n\$ "
</pre>

If you want to install a gem for all of your rubies run
<pre class="brush: bash; light: true;">
rvm gem install gemname
</pre>
if not, you just use your regular gem to install stuff (it should be using the specific gem for your chosen ruby - as you can see below).
<pre class="brush: bash; light: true;">
$ which ruby
/Users/jao/.rvm/rubies/ree-1.8.7-2010.01/bin/ruby
$ which gem
/Users/jao/.rvm/rubies/ree-1.8.7-2010.01/bin/gem
</pre>

I think that sums it up. Have fun!
And ask questions or say if something is wrong in the comments.
